if (localStorage.getItem("cart") == null) {
    var cart = {};
} else {
    cart = JSON.parse(localStorage.getItem("cart"));
}

function cartItems(cart) {
    let total = 0

    for (item in cart) {
        let quantity = cart[item][0];
        let name = cart[item][1];
        let price = cart[item][2];
        itemString = `<li>
                        <a href="#" class="minicart-product-image">
                            <img src="/static/assets/images/product/small-size/5.jpg"
                                 alt="cart products">
                        </a>
                        <div class="minicart-product-details">
                            <h6><a href="#">${name}</a></h6>
                            <span>£${price / quantity} x ${quantity}</span>
                        </div>
                        <button class="close" title="Remove">
                            <i class="fa fa-close"></i>
                        </button>
                    </li>`;
        jq("#cart").append(itemString);

        total += parseFloat(price)
    }

    document.getElementById("total1").innerHTML = `£${total}<span class="cart-item-count">${Object.keys(cart).length}</span>`
    document.getElementById("total2").innerHTML = `£${total}`
}

function checkout(cart){
    let total = 0

    for (item in cart) {
        let quantity = cart[item][0];
        let name = cart[item][1];
        let price = cart[item][2];
        itemString = ` <tr class="cart_item">
                                <td class="cart-product-name"> ${name}<strong class="product-quantity"> ×
                                    ${quantity}</strong></td>
                                <td class="cart-product-total"><span class="amount">£${price}.00</span></td>
                        </tr>
                      `;
        jq("#checkout").append(itemString);

        total += parseFloat(price);
    }

    jq('#total-cost').val(total);
    jq('#items').val(JSON.stringify(cart));
    document.getElementById("checkout1").innerHTML = `£${total}.00`
    document.getElementById("checkout2").innerHTML = `£${total}.00`

}

function clearCart(){
    localStorage.clear()
}

var jq = $.noConflict();
jq(document).ready(function () {

    jq(document).on("click", "#order", clearCart);

    cartItems(cart);
    checkout(cart);

});
